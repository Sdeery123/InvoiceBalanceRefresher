<Window x:Class="InvoiceBalanceRefresher.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:converters="clr-namespace:InvoiceBalanceRefresher.Converters"
        xmlns:local="clr-namespace:InvoiceBalanceRefresher.Converters"
        x:Name="ThisWindow"
        Title="Invoice Balance Refresher" 
        Height="800" Width="1100"
        WindowStartupLocation="CenterScreen"
        Background="Transparent"
        AllowsTransparency="True"
        WindowStyle="None"
        BorderThickness="0">

    <Window.InputBindings>
        <!-- Save credentials (Ctrl+S) -->
        <KeyBinding Key="S" Modifiers="Control" 
                    Command="{Binding ElementName=ThisWindow, Path=SaveCredentialsCommand}"/>

        <!-- Open CSV file (Ctrl+O) -->
        <KeyBinding Key="O" Modifiers="Control" 
                    Command="{Binding ElementName=ThisWindow, Path=BrowseCSVCommand}"/>

        <!-- Process single invoice (Ctrl+P) -->
        <KeyBinding Key="P" Modifiers="Control" 
                    Command="{Binding ElementName=ThisWindow, Path=ProcessInvoiceCommand}"/>

        <!-- Process batch (Ctrl+B) -->
        <KeyBinding Key="B" Modifiers="Control" 
                    Command="{Binding ElementName=ThisWindow, Path=ProcessBatchCommand}"/>

        <!-- Clear log (Ctrl+L) -->
        <KeyBinding Key="L" Modifiers="Control" 
                    Command="{Binding ElementName=ThisWindow, Path=ClearLogCommand}"/>

        <!-- Focus search box (Ctrl+F) -->
        <KeyBinding Key="F" Modifiers="Control" 
                    Command="{Binding ElementName=ThisWindow, Path=FocusSearchCommand}"/>

        <!-- Show documentation (F1) -->
        <KeyBinding Key="F1" 
                    Command="{Binding ElementName=ThisWindow, Path=ShowDocumentationCommand}"/>

        <!-- Open credential manager (Ctrl+M) -->
        <KeyBinding Key="M" Modifiers="Control" 
                    Command="{Binding ElementName=ThisWindow, Path=ManageCredentialsCommand}"/>

        <!-- Cycle through credential sets (Ctrl+Tab) -->
        <KeyBinding Key="Tab" Modifiers="Control" 
                    Command="{Binding ElementName=ThisWindow, Path=CycleCredentialSetsCommand}"/>

        <!-- Toggle console log (Ctrl+`) -->
        <KeyBinding Key="l" Modifiers="Control" 
                    Command="{Binding ElementName=ThisWindow, Path=ToggleConsoleCommand}"/>
    </Window.InputBindings>

    <Window.Resources>
        <!-- Keep existing converters -->
        <local:OpacityConverter x:Key="OpacityConverter"/>

        <!-- Enhanced Animation Resources -->
        <Storyboard x:Key="FadeIn">
            <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0" To="1" Duration="0:0:0.4">
                <DoubleAnimation.EasingFunction>
                    <QuinticEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>

        <Storyboard x:Key="SlideIn">
            <ThicknessAnimation Storyboard.TargetProperty="Margin" From="0,20,0,0" To="0,0,0,0" Duration="0:0:0.4">
                <ThicknessAnimation.EasingFunction>
                    <QuinticEase EasingMode="EaseOut"/>
                </ThicknessAnimation.EasingFunction>
            </ThicknessAnimation>
        </Storyboard>

        <!-- Enhanced Console Animation -->
        <Storyboard x:Key="ExpandConsole">
            <DoubleAnimation Storyboard.TargetProperty="Height" To="160" Duration="0:0:0.3">
                <DoubleAnimation.EasingFunction>
                    <QuinticEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0.6" To="1" Duration="0:0:0.3"/>
        </Storyboard>

        <Storyboard x:Key="CollapseConsole">
            <DoubleAnimation Storyboard.TargetProperty="Height" To="0" Duration="0:0:0.3">
                <DoubleAnimation.EasingFunction>
                    <QuinticEase EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation Storyboard.TargetProperty="Opacity" From="1" To="0.6" Duration="0:0:0.3"/>
        </Storyboard>

        <!-- Enhanced color scheme - refined gradient backgrounds -->
        <LinearGradientBrush x:Key="WindowBackgroundBrush" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#F0F4F8" Offset="0"/>
            <GradientStop Color="#E9F2FF" Offset="1"/>
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="CardBackgroundBrush" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#FFFFFF" Offset="0"/>
            <GradientStop Color="#F8FAFF" Offset="1"/>
        </LinearGradientBrush>

        <SolidColorBrush x:Key="ForegroundBrush" Color="#2C3E50"/>
        <SolidColorBrush x:Key="BorderBrush" Color="#D0E1F9"/>
        <SolidColorBrush x:Key="HighlightBrush" Color="#E6F2FF"/>

        <LinearGradientBrush x:Key="GroupBackgroundBrush" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#F7FAFF" Offset="0"/>
            <GradientStop Color="#F0F7FF" Offset="1"/>
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="ConsoleBackgroundBrush" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#EEF5FF" Offset="0"/>
            <GradientStop Color="#E5F0FF" Offset="1"/>
        </LinearGradientBrush>

        <SolidColorBrush x:Key="SeparatorBrush" Color="#CFE2FF"/>

        <!-- Enhanced Color Scheme with refined accent colors -->
        <SolidColorBrush x:Key="PrimaryBrush" Color="#2563EB"/>
        <SolidColorBrush x:Key="PrimaryLightBrush" Color="#4B83F0"/>
        <SolidColorBrush x:Key="SecondaryBrush" Color="#10B981"/>
        <SolidColorBrush x:Key="AccentBrush" Color="#16A34A"/>
        <SolidColorBrush x:Key="AccentAltBrush" Color="#8B5CF6"/>
        <SolidColorBrush x:Key="CharcoalBrush" Color="#1E293B"/>
        <SolidColorBrush x:Key="WarningBrush" Color="#F59E0B"/>
        <SolidColorBrush x:Key="ErrorBrush" Color="#EF4444"/>
        <SolidColorBrush x:Key="SuccessBrush" Color="#22C55E"/>
        <SolidColorBrush x:Key="InfoBrush" Color="#3B82F6"/>

        <!-- Enhanced Color Palette -->
        <SolidColorBrush x:Key="MintGreenBrush" Color="#10B981"/>
        <SolidColorBrush x:Key="MintGreenLightBrush" Color="#34D399"/>
        <SolidColorBrush x:Key="LavenderBrush" Color="#8B5CF6"/>
        <SolidColorBrush x:Key="SoftYellowBrush" Color="#FBBF24"/>
        <SolidColorBrush x:Key="SoftOrangeBrush" Color="#F97316"/>

        <!-- Refined Typography Styles -->
        <Style x:Key="AppTitle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="28"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="{StaticResource PrimaryBrush}"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect ShadowDepth="1" Direction="320" Opacity="0.2" BlurRadius="2" Color="#2563EB"/>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SectionTitle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="{StaticResource ForegroundBrush}"/>
            <Setter Property="Margin" Value="0,0,0,15"/>
        </Style>

        <Style x:Key="CardTitle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="{StaticResource ForegroundBrush}"/>
            <Setter Property="Margin" Value="0,0,0,12"/>
        </Style>

        <Style x:Key="FieldLabel" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Foreground" Value="{StaticResource ForegroundBrush}"/>
            <Setter Property="Margin" Value="0,0,0,5"/>
            <Setter Property="Opacity" Value="0.85"/>
        </Style>

        <Style x:Key="Caption" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="{StaticResource ForegroundBrush}"/>
            <Setter Property="Opacity" Value="0.7"/>
        </Style>

        <Style x:Key="StatusText" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="{StaticResource InfoBrush}"/>
        </Style>

        <!-- Control Styles -->
        <Style TargetType="TextBlock">
            <Setter Property="Foreground" Value="{StaticResource ForegroundBrush}"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
        </Style>

        <!-- Enhanced Modern Card Style -->
        <Style x:Key="ModernCard" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource CardBackgroundBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="16"/>
            <Setter Property="Padding" Value="24"/>
            <Setter Property="Margin" Value="0,0,0,20"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="18" Direction="315" ShadowDepth="3" Opacity="0.12" Color="#3B82F6"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Enhanced Modern TextBox -->
        <Style TargetType="TextBox">
            <Setter Property="Background" Value="{StaticResource GroupBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource ForegroundBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="14,10"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Height" Value="42"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TextBox}">
                        <Border x:Name="border" CornerRadius="10" Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}"
                                SnapsToDevicePixels="True">
                            <ScrollViewer x:Name="PART_ContentHost" Focusable="false" Padding="{TemplateBinding Padding}"
                                         SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter Property="BorderBrush" TargetName="border" Value="{StaticResource PrimaryLightBrush}"/>
                                <Setter Property="Background" TargetName="border">
                                    <Setter.Value>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                            <GradientStop Color="#F7FAFF" Offset="0"/>
                                            <GradientStop Color="#EBF3FF" Offset="1"/>
                                        </LinearGradientBrush>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsKeyboardFocused" Value="true">
                                <Setter Property="BorderBrush" TargetName="border" Value="{StaticResource PrimaryBrush}"/>
                                <Setter Property="BorderThickness" TargetName="border" Value="2"/>
                                <Setter Property="Effect" TargetName="border">
                                    <Setter.Value>
                                        <DropShadowEffect BlurRadius="8" Direction="315" ShadowDepth="1" Opacity="0.15" Color="#3B82F6"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Enhanced Modern Button -->
        <Style TargetType="Button">
            <Setter Property="Background" Value="{StaticResource MintGreenBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="{StaticResource MintGreenBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="20,12"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Height" Value="42"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Border x:Name="border" CornerRadius="10" Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter x:Name="contentPresenter" ContentTemplate="{TemplateBinding ContentTemplate}" 
                                             Content="{TemplateBinding Content}" HorizontalAlignment="Center" 
                                             VerticalAlignment="Center" Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{StaticResource MintGreenLightBrush}"/>
                                <Setter Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect BlurRadius="12" Direction="315" ShadowDepth="3" Opacity="0.25" Color="#10B981"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="{StaticResource MintGreenBrush}"/>
                                <Setter Property="Opacity" Value="0.9"/>
                                <Setter Property="RenderTransform">
                                    <Setter.Value>
                                        <ScaleTransform ScaleX="0.98" ScaleY="0.98"/>
                                    </Setter.Value>
                                </Setter>
                                <Setter Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect BlurRadius="6" Direction="315" ShadowDepth="1" Opacity="0.15" Color="#10B981"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Secondary Button -->
        <Style x:Key="SecondaryButton" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource MintGreenBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource MintGreenBrush}"/>
            <Setter Property="BorderThickness" Value="1.5"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background">
                        <Setter.Value>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                <GradientStop Color="#F0FDF9" Offset="0"/>
                                <GradientStop Color="#ECFDF5" Offset="1"/>
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="BorderBrush" Value="{StaticResource MintGreenLightBrush}"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background">
                        <Setter.Value>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                <GradientStop Color="#ECFDF5" Offset="0"/>
                                <GradientStop Color="#D1FAE5" Offset="1"/>
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="Opacity" Value="0.9"/>
                    <Setter Property="RenderTransform">
                        <Setter.Value>
                            <ScaleTransform ScaleX="0.98" ScaleY="0.98"/>
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Action Button -->
        <Style x:Key="ActionButton" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Background">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                        <GradientStop Color="#16A34A" Offset="0"/>
                        <GradientStop Color="#15803D" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="Foreground" Value="White"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background">
                        <Setter.Value>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                <GradientStop Color="#22C55E" Offset="0"/>
                                <GradientStop Color="#16A34A" Offset="1"/>
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="Effect">
                        <Setter.Value>
                            <DropShadowEffect BlurRadius="12" Direction="315" ShadowDepth="3" Opacity="0.25" Color="#16A34A"/>
                        </Setter.Value>
                    </Setter>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background">
                        <Setter.Value>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                <GradientStop Color="#15803D" Offset="0"/>
                                <GradientStop Color="#166534" Offset="1"/>
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="RenderTransform">
                        <Setter.Value>
                            <ScaleTransform ScaleX="0.98" ScaleY="0.98"/>
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Enhanced Icon Button -->
        <Style x:Key="IconButton" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource ForegroundBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Width" Value="40"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Border x:Name="border" CornerRadius="10" Background="{TemplateBinding Background}">
                            <ContentPresenter x:Name="contentPresenter" ContentTemplate="{TemplateBinding ContentTemplate}" 
                                             Content="{TemplateBinding Content}" HorizontalAlignment="Center" 
                                             VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{StaticResource HighlightBrush}"/>
                                <Setter Property="RenderTransform" TargetName="contentPresenter">
                                    <Setter.Value>
                                        <ScaleTransform ScaleX="1.1" ScaleY="1.1"/>
                                    </Setter.Value>
                                </Setter>
                                <Setter Property="RenderTransformOrigin" TargetName="contentPresenter" Value="0.5,0.5"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="{StaticResource HighlightBrush}"/>
                                <Setter Property="Opacity" Value="0.8"/>
                                <Setter Property="RenderTransform" TargetName="contentPresenter">
                                    <Setter.Value>
                                        <ScaleTransform ScaleX="0.9" ScaleY="0.9"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Enhanced Toggle Button Style -->
        <Style x:Key="ToggleIconButton" TargetType="ToggleButton">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource ForegroundBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Width" Value="40"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                        <Border x:Name="border" CornerRadius="10" Background="{TemplateBinding Background}">
                            <ContentPresenter x:Name="contentPresenter" ContentTemplate="{TemplateBinding ContentTemplate}" 
                                             Content="{TemplateBinding Content}" HorizontalAlignment="Center" 
                                             VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{StaticResource HighlightBrush}"/>
                                <Setter Property="RenderTransform" TargetName="contentPresenter">
                                    <Setter.Value>
                                        <ScaleTransform ScaleX="1.1" ScaleY="1.1"/>
                                    </Setter.Value>
                                </Setter>
                                <Setter Property="RenderTransformOrigin" TargetName="contentPresenter" Value="0.5,0.5"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="{StaticResource HighlightBrush}"/>
                                <Setter Property="Opacity" Value="0.8"/>
                            </Trigger>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter Property="Background" Value="{StaticResource HighlightBrush}"/>
                                <Setter Property="Foreground" Value="{StaticResource PrimaryBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Primary Button (alias for default button style) -->
        <Style x:Key="PrimaryButton" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}"/>

        <!-- Enhanced TabControl -->
        <Style TargetType="TabControl">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TabControl}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <Border Grid.Row="0" Background="Transparent" BorderThickness="0" Padding="0,0,0,15">
                                <TabPanel x:Name="HeaderPanel" Panel.ZIndex="1" IsItemsHost="True" 
                                         Background="Transparent" Margin="0"/>
                            </Border>

                            <Border Grid.Row="1" Background="Transparent" BorderThickness="0">
                                <ContentPresenter x:Name="PART_SelectedContentHost" ContentSource="SelectedContent"/>
                            </Border>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Enhanced TabItem -->
        <Style TargetType="TabItem">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource ForegroundBrush}"/>
            <Setter Property="Opacity" Value="0.7"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="20,12"/>
            <Setter Property="Margin" Value="0,0,10,0"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TabItem}">
                        <Grid x:Name="templateRoot" SnapsToDevicePixels="True">
                            <Border x:Name="mainBorder" CornerRadius="10" BorderThickness="0" Background="Transparent">
                                <ContentPresenter x:Name="contentPresenter" ContentSource="Header" Focusable="False" 
                                                HorizontalAlignment="Center" VerticalAlignment="Center" 
                                                Margin="{TemplateBinding Padding}"/>
                            </Border>
                            <Border x:Name="selectedBorder" CornerRadius="2" Height="3" Background="{StaticResource MintGreenBrush}" 
                                   Visibility="Collapsed" Margin="12,0,12,0" VerticalAlignment="Bottom"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Opacity" Value="1" TargetName="templateRoot"/>
                                <Setter Property="Visibility" Value="Visible" TargetName="selectedBorder"/>
                                <Setter Property="Background" Value="{StaticResource HighlightBrush}" TargetName="mainBorder"/>
                                <Setter Property="TextElement.Foreground" Value="{StaticResource PrimaryBrush}" TargetName="contentPresenter"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{StaticResource HighlightBrush}" TargetName="mainBorder"/>
                                <Setter Property="Opacity" Value="0.9" TargetName="templateRoot"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Updated ComboBox Style -->
        <Style TargetType="ComboBox">
            <Setter Property="Background" Value="{StaticResource GroupBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource ForegroundBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="14,10"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Height" Value="42"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ComboBox}">
                        <Grid>
                            <Border x:Name="border" CornerRadius="10" Background="{TemplateBinding Background}" 
                            BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <ContentPresenter x:Name="contentPresenter" ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}" 
                                            Content="{TemplateBinding SelectionBoxItem}" ContentStringFormat="{TemplateBinding SelectionBoxItemStringFormat}"
                                            IsHitTestVisible="False" Margin="{TemplateBinding Padding}"
                                            VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                                    <Path Grid.Column="1" x:Name="arrow" Data="M0,0 L8,0 L4,4 z" Fill="{StaticResource ForegroundBrush}" 
                                  Margin="0,0,16,0" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                </Grid>
                            </Border>
                            <Popup x:Name="PART_Popup" AllowsTransparency="True" 
                          IsOpen="{Binding IsDropDownOpen, RelativeSource={RelativeSource TemplatedParent}}" 
                          Placement="Bottom" PopupAnimation="Slide"
                          Focusable="False"
                          StaysOpen="False">
                                <Border x:Name="dropDownBorder" CornerRadius="10" Background="{StaticResource CardBackgroundBrush}"
                                BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" Padding="6">
                                    <ScrollViewer Focusable="False" SnapsToDevicePixels="True" MaxHeight="200">
                                        <StackPanel IsItemsHost="True" Focusable="False" KeyboardNavigation.DirectionalNavigation="Contained"/>
                                    </ScrollViewer>
                                </Border>
                            </Popup>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter Property="BorderBrush" TargetName="border" Value="{StaticResource PrimaryLightBrush}"/>
                            </Trigger>
                            <Trigger Property="IsDropDownOpen" Value="true">
                                <Setter Property="BorderBrush" TargetName="border" Value="{StaticResource PrimaryBrush}"/>
                                <Setter Property="Effect" TargetName="dropDownBorder">
                                    <Setter.Value>
                                        <DropShadowEffect BlurRadius="12" Direction="315" ShadowDepth="3" Opacity="0.2" Color="#3B82F6"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>


        <Style TargetType="ComboBoxItem">
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ComboBoxItem}">
                        <Border x:Name="Border" Background="{TemplateBinding Background}" 
                      BorderBrush="{TemplateBinding BorderBrush}" 
                      BorderThickness="{TemplateBinding BorderThickness}" 
                      CornerRadius="6" Padding="{TemplateBinding Padding}">
                            <ContentPresenter />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" TargetName="Border" Value="{StaticResource HighlightBrush}"/>
                                <Setter Property="TextElement.FontWeight" Value="SemiBold"/>
                                <Setter Property="TextElement.Foreground" Value="{StaticResource PrimaryBrush}"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" TargetName="Border" Value="{StaticResource HighlightBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>



        <!-- Enhanced DataGrid Styles -->
        <Style TargetType="DataGrid">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="RowBackground" Value="{StaticResource CardBackgroundBrush}"/>
            <Setter Property="AlternatingRowBackground" Value="{StaticResource CardBackgroundBrush}"/>
            <Setter Property="HorizontalGridLinesBrush" Value="{StaticResource BorderBrush}"/>
            <Setter Property="VerticalGridLinesBrush" Value="{StaticResource BorderBrush}"/>
            <Setter Property="RowHeight" Value="48"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="SelectionMode" Value="Single"/>
            <Setter Property="SelectionUnit" Value="FullRow"/>
            <Setter Property="CanUserAddRows" Value="False"/>
            <Setter Property="CanUserDeleteRows" Value="False"/>
            <Setter Property="CanUserResizeRows" Value="False"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
        </Style>

        <Style TargetType="DataGridRow">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background">
                        <Setter.Value>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                <GradientStop Color="#E6F2FF" Offset="0"/>
                                <GradientStop Color="#EBF3FF" Offset="1"/>
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>
                </Trigger>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background">
                        <Setter.Value>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                <GradientStop Color="#F0F7FF" Offset="0"/>
                                <GradientStop Color="#F5F9FF" Offset="1"/>
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource ForegroundBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="Padding" Value="12,16"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
        </Style>

        <Style TargetType="DataGridCell">
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="12,0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type DataGridCell}">
                        <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" 
                                BorderThickness="{TemplateBinding BorderThickness}" Padding="{TemplateBinding Padding}" 
                                SnapsToDevicePixels="True">
                            <ContentPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" 
                                             VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="Transparent"/>
                    <Setter Property="Foreground" Value="{StaticResource PrimaryBrush}"/>
                    <Setter Property="FontWeight" Value="SemiBold"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Enhanced ProgressBar -->
        <Style TargetType="ProgressBar">
            <Setter Property="Background">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                        <GradientStop Color="#E9F2FF" Offset="0"/>
                        <GradientStop Color="#F3F8FF" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="Foreground">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                        <GradientStop Color="#34D399" Offset="0"/>
                        <GradientStop Color="#10B981" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="Height" Value="8"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ProgressBar">
                        <Grid>
                            <Border x:Name="PART_Track" Background="{TemplateBinding Background}" CornerRadius="4"/>
                            <Border x:Name="PART_Indicator" Background="{TemplateBinding Foreground}" 
                                    CornerRadius="4" HorizontalAlignment="Left"/>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Enhanced Radio Button -->
        <Style TargetType="RadioButton">
            <Setter Property="Foreground" Value="{StaticResource ForegroundBrush}"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Grid x:Name="templateRoot" Background="Transparent">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Border x:Name="radioButtonBorder" BorderBrush="{StaticResource BorderBrush}" BorderThickness="2" 
                                   Background="{StaticResource GroupBackgroundBrush}" CornerRadius="12" 
                                   Width="22" Height="22" VerticalAlignment="Center">
                                <Ellipse x:Name="radioMark" Fill="{StaticResource MintGreenBrush}" Margin="4" 
                                        Opacity="0"/>
                            </Border>
                            <ContentPresenter x:Name="contentPresenter" Grid.Column="1" Margin="12,0,0,0" 
                                            HorizontalAlignment="Left" VerticalAlignment="Center" 
                                            RecognizesAccessKey="True"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter Property="Opacity" TargetName="radioMark" Value="1"/>
                                <Setter Property="BorderBrush" TargetName="radioButtonBorder" Value="{StaticResource MintGreenBrush}"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="BorderBrush" TargetName="radioButtonBorder" Value="{StaticResource PrimaryLightBrush}"/>
                                <Setter Property="Effect" TargetName="radioButtonBorder">
                                    <Setter.Value>
                                        <DropShadowEffect BlurRadius="5" Direction="315" ShadowDepth="1" Opacity="0.1" Color="#3B82F6"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Enhanced RichTextBox Style -->
        <Style TargetType="RichTextBox">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="{StaticResource ForegroundBrush}"/>
            <Setter Property="IsReadOnly" Value="True"/>
            <Setter Property="Padding" Value="12"/>
        </Style>

        <!-- Enhanced Menu Style -->
        <Style TargetType="Menu">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource ForegroundBrush}"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Padding" Value="0"/>
        </Style>

        <!-- Enhanced MenuItem Style -->
        <Style TargetType="MenuItem">
            <Setter Property="Foreground" Value="{StaticResource ForegroundBrush}"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Padding" Value="10,6"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type MenuItem}">
                        <Border x:Name="templateRoot" CornerRadius="6" Background="{TemplateBinding Background}" 
                               BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" 
                               SnapsToDevicePixels="True">
                            <Grid VerticalAlignment="Center">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <ContentPresenter x:Name="Icon" ContentSource="Icon" Margin="4,0,8,0" 
                                                 VerticalAlignment="Center" HorizontalAlignment="Center"/>

                                <ContentPresenter x:Name="menuHeaderPresenter" ContentTemplate="{TemplateBinding HeaderTemplate}" 
                                                 Content="{TemplateBinding Header}" Grid.Column="1" ContentStringFormat="{TemplateBinding HeaderStringFormat}" 
                                                 ContentSource="Header" Margin="{TemplateBinding Padding}" RecognizesAccessKey="True" 
                                                 SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="Center"/>

                                <TextBlock x:Name="menuGestureText" Grid.Column="2" Margin="10,0,10,0" 
                                          Text="{TemplateBinding InputGestureText}" VerticalAlignment="Center" 
                                          Opacity="0.7"/>

                                <Path x:Name="ArrowPath" Grid.Column="3" HorizontalAlignment="Center" VerticalAlignment="Center" 
                                     Data="M0,0 L4,4 L0,8 Z" Fill="{TemplateBinding Foreground}" Visibility="Collapsed"/>

                                <Popup x:Name="PART_Popup" AllowsTransparency="True" Focusable="False" 
                                      IsOpen="{Binding IsSubmenuOpen, RelativeSource={RelativeSource TemplatedParent}}" 
                                      PopupAnimation="Fade" Placement="Right">
                                    <Border x:Name="SubMenuBorder" Background="{StaticResource CardBackgroundBrush}" 
                                           BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" Padding="3" 
                                           CornerRadius="6" Effect="{TemplateBinding Effect}">
                                        <ScrollViewer x:Name="SubMenuScrollViewer" Style="{DynamicResource {ComponentResourceKey ResourceId=MenuScrollViewer, TypeInTargetAssembly={x:Type FrameworkElement}}}">
                                            <ItemsPresenter x:Name="ItemsPresenter" KeyboardNavigation.DirectionalNavigation="Cycle" 
                                                          Grid.IsSharedSizeScope="True" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" 
                                                          KeyboardNavigation.TabNavigation="Cycle"/>
                                        </ScrollViewer>
                                    </Border>
                                </Popup>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="HasDropShadow" SourceName="PART_Popup" Value="True">
                                <Setter Property="Effect" TargetName="SubMenuBorder">
                                    <Setter.Value>
                                        <DropShadowEffect BlurRadius="12" Direction="315" ShadowDepth="3" Opacity="0.2"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="Role" Value="TopLevelHeader">
                                <Setter Property="Padding" Value="10,6,10,6"/>
                                <Setter Property="Placement" TargetName="PART_Popup" Value="Bottom"/>
                                <Setter Property="HorizontalAlignment" TargetName="ArrowPath" Value="Center"/>
                                <Setter Property="VerticalAlignment" TargetName="ArrowPath" Value="Center"/>
                                <Setter Property="Margin" TargetName="ArrowPath" Value="0,0,0,0"/>
                                <Setter Property="Data" TargetName="ArrowPath" Value="M 0,0 L 4,4 L 8,0 Z"/>
                            </Trigger>
                            <Trigger Property="Role" Value="TopLevelItem">
                                <Setter Property="Padding" Value="10,6,10,6"/>
                            </Trigger>
                            <Trigger Property="Role" Value="SubmenuHeader">
                                <Setter Property="Visibility" TargetName="ArrowPath" Value="Visible"/>
                            </Trigger>
                            <Trigger Property="IsHighlighted" Value="True">
                                <Setter Property="Background" TargetName="templateRoot" Value="{StaticResource HighlightBrush}"/>
                            </Trigger>
                            <Trigger Property="IsSubmenuOpen" Value="True">
                                <Setter Property="Background" TargetName="templateRoot" Value="{StaticResource HighlightBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Enhanced Checkbox Style -->
        <Style TargetType="CheckBox">
            <Setter Property="Foreground" Value="{StaticResource ForegroundBrush}"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <Grid x:Name="templateRoot" Background="Transparent">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Border x:Name="checkBoxBorder" BorderBrush="{StaticResource BorderBrush}" BorderThickness="2" 
                                   Background="{StaticResource GroupBackgroundBrush}" CornerRadius="6" 
                                   Width="20" Height="20" VerticalAlignment="Center">
                                <Path x:Name="checkMark" Data="M2,8 L6,12 L12,3" Stroke="{StaticResource MintGreenBrush}"
                                     StrokeThickness="2" Stretch="Uniform" Margin="2" Visibility="Collapsed"/>
                            </Border>
                            <ContentPresenter x:Name="contentPresenter" Grid.Column="1" Margin="12,0,0,0" 
                                            HorizontalAlignment="Left" VerticalAlignment="Center" 
                                            RecognizesAccessKey="True"/>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter Property="Visibility" TargetName="checkMark" Value="Visible"/>
                                <Setter Property="BorderBrush" TargetName="checkBoxBorder" Value="{StaticResource MintGreenBrush}"/>
                                <Setter Property="Background" TargetName="checkBoxBorder" Value="#F0FDFA"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="BorderBrush" TargetName="checkBoxBorder" Value="{StaticResource PrimaryLightBrush}"/>
                                <Setter Property="Effect" TargetName="checkBoxBorder">
                                    <Setter.Value>
                                        <DropShadowEffect BlurRadius="5" Direction="315" ShadowDepth="1" Opacity="0.1" Color="#3B82F6"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <!-- Main Window with Enhanced Custom Chrome -->
    <Border Background="{StaticResource WindowBackgroundBrush}" CornerRadius="20">
        <Border.Effect>
            <DropShadowEffect BlurRadius="25" Direction="315" ShadowDepth="4" Opacity="0.15" Color="#3B82F6"/>
        </Border.Effect>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Enhanced Title Bar with subtle gradient -->
            <Border Grid.Row="0" Background="Transparent" Height="70" CornerRadius="20 20 0 0">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="10" Direction="270" ShadowDepth="1" Opacity="0.05" Color="#000000"/>
                </Border.Effect>
                <Grid MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- App Logo and Title with subtle shadow -->
                    <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="24,0,0,0" VerticalAlignment="Center">
                        <!-- Logo Icon (optional) -->
                        <Path Width="28" Height="28" Margin="0,0,12,0" Fill="{StaticResource PrimaryBrush}" Stretch="Uniform" 
                              Data="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,6A6,6 0 0,0 6,12A6,6 0 0,0 12,18A6,6 0 0,0 18,12A6,6 0 0,0 12,6M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8Z"/>

                        <TextBlock x:Name="AppTitle" Text="INVOICE BALANCE REFRESHER" Style="{StaticResource AppTitle}"/>
                    </StackPanel>

                    <!-- Enhanced Window Controls with animations -->
                    <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,24,0">
                        <Button x:Name="MinimizeButton" Style="{StaticResource IconButton}" Click="MinimizeButton_Click" 
                               ToolTip="Minimize" Width="42" Height="42">
                            <Path Width="12" Height="1" Stroke="{StaticResource ForegroundBrush}" StrokeThickness="1.5"
                                  Stretch="Fill" Margin="0,0,0,0"/>
                        </Button>

                        <Button x:Name="MaximizeButton" Style="{StaticResource IconButton}" Click="MaximizeButton_Click" 
                               ToolTip="Maximize" Width="42" Height="42" Margin="5,0">
                            <Path Width="12" Height="12" Stroke="{StaticResource ForegroundBrush}" StrokeThickness="1.5"
                                  Data="M1,1 L11,1 L11,11 L1,11 Z" Stretch="Fill"/>
                        </Button>

                        <Button x:Name="CloseButton" Style="{StaticResource IconButton}" Click="CloseButton_Click" 
                               ToolTip="Close" Width="42" Height="42">
                            <Path Width="12" Height="12" Stroke="{StaticResource ErrorBrush}" StrokeThickness="1.5"
                                  Data="M1,1 L11,11 M1,11 L11,1" Stretch="Fill"/>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Content Area with enhanced padding -->
            <Grid Grid.Row="1" Margin="24,0,24,20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Enhanced Menu Bar with subtle highlight -->
                <Border Grid.Row="0" Background="Transparent" Margin="0,0,0,20" CornerRadius="12">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- Main Menu with enhanced hover effects -->
                        <Menu Grid.Column="0" Margin="0,5,0,10" Background="Transparent">
                            <MenuItem Header="File">
                                <MenuItem Header="Create Sample CSV" Click="GenerateSampleCSV_Click"/>
                                <Separator/>
                                <MenuItem Header="Save Logs" Click="SaveLogs_Click"/>
                                <Separator/>
                                <MenuItem Header="Exit" Click="Exit_Click"/>
                            </MenuItem>
                            <MenuItem Header="Tools">
                                <MenuItem Header="Manage Credentials" Click="ManageCredentials_Click"/>
                                <MenuItem Header="Rate Limiting Settings" Click="RateLimitSettings_Click"/>
                                <MenuItem Header="Maintenance Settings" Click="OpenMaintenanceSettings_Click"/>
                                <MenuItem Header="Run Maintenance" Click="RunMaintenanceButton_Click"/>
                            </MenuItem>
                            <MenuItem Header="Help">
                                <MenuItem Header="Documentation" Click="Documentation_Click"/>
                                <MenuItem Header="About" Click="About_Click"/>
                            </MenuItem>
                        </Menu>
                    </Grid>
                </Border>

                <!-- Enhanced Main Tab Control with more distinct tabs -->
                <TabControl Grid.Row="1" x:Name="MainTabControl">
                    <!-- Single Invoice Tab -->
                    <TabItem Header="Single Invoice">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <Border Style="{StaticResource ModernCard}">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>

                                    <!-- Card Title with icon -->
                                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,20">
                                        <Path Width="20" Height="20" Fill="{StaticResource PrimaryBrush}" Margin="0,0,10,0"
                                              Data="M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M19,5V19H5V5H19Z M17,11H7V13H17V11Z"/>

                                        <TextBlock Text="PROCESS SINGLE INVOICE" Style="{StaticResource SectionTitle}" 
                                                   VerticalAlignment="Center"/>
                                    </StackPanel>

                                    <!-- Form Grid with enhanced spacing -->
                                    <Grid Grid.Row="1" Margin="0,0,0,24">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="180"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- Enhanced Credentials Selection -->
                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Credential Set" Style="{StaticResource FieldLabel}" 
                                                   VerticalAlignment="Bottom"/>
                                        <ComboBox Grid.Row="0" Grid.Column="1" x:Name="CredentialSetComboBox" DisplayMemberPath="Name"
                                                 Margin="0,0,10,14" SelectionChanged="CredentialSetComboBox_SelectionChanged"/>
                                        <Button Grid.Row="0" Grid.Column="2" Content="Manage" Width="110" Style="{StaticResource SecondaryButton}"
                                               Click="ManageCredentials_Click" Margin="0,0,0,14"/>

                                        <!-- Enhanced Biller GUID -->
                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Biller GUID" Style="{StaticResource FieldLabel}" 
                                                   VerticalAlignment="Center"/>
                                        <TextBox Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="2" x:Name="BillerGUID" Margin="0,0,0,14"/>

                                        <!-- Enhanced Web Service Key -->
                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Web Service Key" Style="{StaticResource FieldLabel}" 
                                                   VerticalAlignment="Center"/>
                                        <TextBox Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="2" x:Name="WebServiceKey" Margin="0,0,0,14"/>

                                        <!-- Enhanced Account Number -->
                                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Account Number" Style="{StaticResource FieldLabel}" 
                                                   VerticalAlignment="Center"/>
                                        <TextBox Grid.Row="3" Grid.Column="1" Grid.ColumnSpan="2" x:Name="AccountNumber" Margin="0,0,0,14"/>

                                        <!-- Enhanced Invoice Number -->
                                        <TextBlock Grid.Row="4" Grid.Column="0" Text="Invoice Number" Style="{StaticResource FieldLabel}" 
                                                   VerticalAlignment="Center"/>
                                        <TextBox Grid.Row="4" Grid.Column="1" Grid.ColumnSpan="2" x:Name="InvoiceNumber" Margin="0,0,0,14"/>
                                    </Grid>

                                    <!-- Process Button and Results with enhanced styling -->
                                    <Grid Grid.Row="2">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>

                                        <!-- Enhanced Process Button -->
                                        <Button Grid.Row="0" Content="PROCESS INVOICE" Style="{StaticResource ActionButton}" 
                                               Width="200" HorizontalAlignment="Left" Margin="0,0,0,20"
                                               Click="ProcessSingleInvoice_Click">
                                            <Button.Effect>
                                                <DropShadowEffect BlurRadius="15" Direction="315" ShadowDepth="3" Opacity="0.2" Color="#16A34A"/>
                                            </Button.Effect>
                                        </Button>

                                        <!-- Results Area with enhanced styling -->
                                        <Border Grid.Row="1" Background="{StaticResource ConsoleBackgroundBrush}" 
                                               CornerRadius="12" MinHeight="200">
                                            <Border.Effect>
                                                <DropShadowEffect BlurRadius="10" Direction="315" ShadowDepth="2" Opacity="0.1" Color="#3B82F6"/>
                                            </Border.Effect>
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto"/>
                                                    <RowDefinition Height="*"/>
                                                </Grid.RowDefinitions>

                                                <TextBlock Text="INVOICE DETAILS" Style="{StaticResource CardTitle}" 
                                                         Margin="15,15,15,5" Foreground="{StaticResource PrimaryBrush}"/>

                                                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="15,0,15,15">
                                                    <TextBlock x:Name="SingleResult" TextWrapping="Wrap"/>
                                                </ScrollViewer>
                                            </Grid>
                                        </Border>
                                    </Grid>
                                </Grid>
                            </Border>
                        </ScrollViewer>
                    </TabItem>

                    <!-- Batch Processing Tab -->
                    <TabItem Header="Batch Processing">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <Border Style="{StaticResource ModernCard}">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>

                                    <!-- Card Title with icon -->
                                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,20">
                                        <Path Width="20" Height="20" Fill="{StaticResource PrimaryBrush}" Margin="0,0,10,0"
                                              Data="M3,5H9V11H3V5M5,7V9H7V7H5M11,7H21V9H11V7M11,15H21V17H11V15M5,13V15H7V13H5M3,13H9V19H3V13Z"/>

                                        <TextBlock Text="BATCH INVOICE PROCESSING" Style="{StaticResource SectionTitle}" 
                                                   VerticalAlignment="Center"/>
                                    </StackPanel>

                                    <!-- Info Panel with enhanced styling -->
                                    <Border Grid.Row="1" CornerRadius="12" Padding="16" Margin="0,0,0,20">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                <GradientStop Color="#E3F2FD" Offset="0"/>
                                                <GradientStop Color="#DBEAFE" Offset="1"/>
                                            </LinearGradientBrush>
                                        </Border.Background>
                                        <Border.Effect>
                                            <DropShadowEffect BlurRadius="10" Direction="315" ShadowDepth="1" Opacity="0.1" Color="#3B82F6"/>
                                        </Border.Effect>
                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                            <Path Data="M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z" 
                                                 Fill="{StaticResource InfoBrush}" Width="20" Height="20" Margin="0,0,12,0" Stretch="Uniform" />
                                            <TextBlock TextWrapping="Wrap" Foreground="{StaticResource InfoBrush}" FontSize="13">
                                                <Run FontWeight="SemiBold">Note:</Run> Biller GUID and Web Service Key are set on the Single Invoice tab
                                            </TextBlock>
                                        </StackPanel>
                                    </Border>

                                    <!-- Format Selection with enhanced styling -->
                                    <Grid Grid.Row="2" Margin="0,0,0,20">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="CSV Format" Style="{StaticResource FieldLabel}" 
                                                   VerticalAlignment="Center" Margin="0,0,20,0"/>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal">
                                            <RadioButton x:Name="InvoiceOnlyFormat" Content="Invoice Numbers Only" IsChecked="True" 
                                                       Margin="0,0,24,0"/>
                                            <RadioButton x:Name="AccountInvoiceFormat" Content="Account Number, Invoice Number Format"/>
                                        </StackPanel>
                                    </Grid>

                                    <!-- File Selection with enhanced styling -->
                                    <Grid Grid.Row="3" Margin="0,0,0,20">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Button Grid.Column="0" Content="SELECT CSV FILE" Style="{StaticResource PrimaryButton}" 
                                               Width="180" Click="BrowseCSV_Click">
                                            <Button.Effect>
                                                <DropShadowEffect BlurRadius="10" Direction="315" ShadowDepth="2" Opacity="0.15" Color="#10B981"/>
                                            </Button.Effect>
                                        </Button>
                                        <Border Grid.Column="1" Background="{StaticResource GroupBackgroundBrush}" 
                                               CornerRadius="10" Padding="15,0" Margin="15,0,0,0">
                                            <TextBlock x:Name="CSVFilePath" Style="{StaticResource FieldLabel}" Margin="0"
                                                     VerticalAlignment="Center" TextTrimming="CharacterEllipsis"/>
                                        </Border>
                                    </Grid>

                                    <!-- Warning Alert with enhanced styling -->
                                    <Border Grid.Row="4" CornerRadius="12" Padding="16" Margin="0,0,0,20">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                <GradientStop Color="#FFF8E1" Offset="0"/>
                                                <GradientStop Color="#FEF3C7" Offset="1"/>
                                            </LinearGradientBrush>
                                        </Border.Background>
                                        <Border.Effect>
                                            <DropShadowEffect BlurRadius="10" Direction="315" ShadowDepth="1" Opacity="0.1" Color="#F59E0B"/>
                                        </Border.Effect>
                                        <StackPanel>
                                            <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                                <Path Data="M12,2L1,21H23M12,6L19.53,19H4.47M11,10V14H13V10M11,16V18H13V16" 
                                                     Fill="{StaticResource WarningBrush}" Width="20" Height="20" Margin="0,0,10,0"/>
                                                <TextBlock FontWeight="SemiBold" Foreground="{StaticResource WarningBrush}" TextWrapping="Wrap" FontSize="14">
                                                    Warning: Each invoice in the batch will make a separate API call
                                                </TextBlock>
                                            </StackPanel>
                                            <StackPanel Margin="30,0,0,0">
                                                <TextBlock Foreground="{StaticResource WarningBrush}" Margin="0,4,0,4" FontSize="13">• Consider API rate limits</TextBlock>
                                                <TextBlock Foreground="{StaticResource WarningBrush}" Margin="0,4,0,4" FontSize="13">• Be aware of potential API usage costs</TextBlock>
                                                <TextBlock Foreground="{StaticResource WarningBrush}" Margin="0,4,0,4" FontSize="13">• Large batches will take longer to process</TextBlock>
                                            </StackPanel>
                                        </StackPanel>
                                    </Border>

                                    <!-- Process Button and Status with enhanced styling -->
                                    <Grid Grid.Row="5" Margin="0,0,0,20">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>

                                        <!-- Process Button -->
                                        <Button Grid.Row="0" Content="PROCESS CSV" Style="{StaticResource ActionButton}" 
                                               Width="180" Click="ProcessCSV_Click" Margin="0,0,0,16" HorizontalAlignment="Left">
                                            <Button.Effect>
                                                <DropShadowEffect BlurRadius="15" Direction="315" ShadowDepth="3" Opacity="0.2" Color="#16A34A"/>
                                            </Button.Effect>
                                        </Button>

                                        <!-- Progress Bar -->
                                        <ProgressBar Grid.Row="1" x:Name="BatchProgress" Margin="0,8,0,8"/>

                                        <!-- Status Text -->
                                        <TextBlock Grid.Row="2" x:Name="BatchStatus" Style="{StaticResource StatusText}" 
                                                  Margin="0,8,0,16"/>

                                        <!-- Search and Results -->
                                        <Grid Grid.Row="3">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="*"/>
                                            </Grid.RowDefinitions>

                                            <!-- Search Bar with enhanced styling -->
                                            <Border Grid.Row="0" Background="{StaticResource GroupBackgroundBrush}" CornerRadius="10" 
                                                   Margin="0,0,0,16" Padding="16,8">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>

                                                    <!-- Search Icon -->
                                                    <Path Grid.Column="0" Data="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" 
                                                         Fill="{StaticResource ForegroundBrush}" Width="20" Height="20" Opacity="0.6" Margin="0,0,12,0"/>

                                                    <!-- Search TextBox -->
                                                    <TextBox Grid.Column="1" x:Name="BatchSearchBox" Height="36" TextChanged="BatchSearchBox_TextChanged" 
                                                           Background="Transparent" BorderThickness="0" Padding="0" Margin="0,0,10,0"/>

                                                    <!-- Clear Button -->
                                                    <Button Grid.Column="2" Style="{StaticResource IconButton}" 
                                                          Click="ClearBatchSearch_Click" ToolTip="Clear Filter" Width="36" Height="36" 
                                                          VerticalAlignment="Center" Margin="0,0,10,0">
                                                        <Path Data="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" 
                                                             Fill="{StaticResource ForegroundBrush}" Width="16" Height="16"/>
                                                    </Button>

                                                    <!-- Results Count -->
                                                    <TextBlock Grid.Column="3" x:Name="BatchSearchResultsCount" Style="{StaticResource Caption}" 
                                                             VerticalAlignment="Center" MinWidth="60"/>
                                                </Grid>
                                            </Border>

                                            <!-- Results Area with enhanced styling -->
                                            <Border Grid.Row="1" Background="{StaticResource ConsoleBackgroundBrush}" 
                                                   CornerRadius="12" MinHeight="300" MaxHeight="500">
                                                <Border.Effect>
                                                    <DropShadowEffect BlurRadius="12" Direction="315" ShadowDepth="2" Opacity="0.1" Color="#3B82F6"/>
                                                </Border.Effect>
                                                <DockPanel LastChildFill="True">
                                                    <Grid DockPanel.Dock="Top" Margin="16,16,16,8">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Text="PROCESSING RESULTS" Style="{StaticResource CardTitle}" 
                                                                 Margin="0" Foreground="{StaticResource PrimaryBrush}"/>
                                                        <Button Grid.Column="1" Content="COPY" Style="{StaticResource SecondaryButton}" 
                                                               Width="80" Height="32"/>
                                                    </Grid>
                                                    <ScrollViewer VerticalScrollBarVisibility="Auto" 
                                                               HorizontalScrollBarVisibility="Auto" 
                                                               Margin="16,0,16,16"
                                                               Padding="0,0,0,10">
                                                        <TextBox x:Name="BatchResults" 
                                                               Background="Transparent" 
                                                               BorderThickness="0" 
                                                               IsReadOnly="True" 
                                                               TextWrapping="Wrap" 
                                                               AcceptsReturn="True"
                                                               Width="{Binding RelativeSource={RelativeSource AncestorType=ScrollViewer}, Path=ViewportWidth}"
                                                               MinHeight="250"
                                                               MaxHeight="10000"
                                                               VerticalAlignment="Stretch"
                                                               HorizontalAlignment="Stretch"
                                                               FontFamily="Cascadia Code, Consolas, Courier New, monospace"
                                                               FontSize="13"
                                                               Padding="5">
                                                            <TextBox.Resources>
                                                                <Style TargetType="TextBox">
                                                                    <Setter Property="Template">
                                                                        <Setter.Value>
                                                                            <ControlTemplate TargetType="TextBox">
                                                                                <ScrollViewer x:Name="PART_ContentHost" 
                                                                                           VerticalScrollBarVisibility="Hidden" 
                                                                                           HorizontalScrollBarVisibility="Hidden"
                                                                                           Background="Transparent" 
                                                                                           Padding="{TemplateBinding Padding}"/>
                                                                            </ControlTemplate>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </TextBox.Resources>
                                                        </TextBox>
                                                    </ScrollViewer>
                                                </DockPanel>
                                            </Border>
                                        </Grid>
                                    </Grid>
                                </Grid>
                            </Border>
                        </ScrollViewer>
                    </TabItem>

                    <!-- Customer Lookup Tab -->
                    <TabItem Header="Customer Lookup">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <Border Style="{StaticResource ModernCard}">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>

                                    <!-- Card Title with icon -->
                                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,20">
                                        <Path Width="20" Height="20" Fill="{StaticResource PrimaryBrush}" Margin="0,0,10,0"
                                              Data="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,6A2,2 0 0,0 10,8A2,2 0 0,0 12,10A2,2 0 0,0 14,8A2,2 0 0,0 12,6M12,13C14.67,13 20,14.33 20,17V20H4V17C4,14.33 9.33,13 12,13M12,14.9C9.03,14.9 5.9,16.36 5.9,17V18.1H18.1V17C18.1,16.36 14.97,14.9 12,14.9Z"/>

                                        <TextBlock Text="CUSTOMER RECORD LOOKUP" Style="{StaticResource SectionTitle}" 
                                                   VerticalAlignment="Center"/>
                                    </StackPanel>

                                    <!-- Info Panel with enhanced styling -->
                                    <Border Grid.Row="1" CornerRadius="12" Padding="16" Margin="0,0,0,20">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                <GradientStop Color="#E3F2FD" Offset="0"/>
                                                <GradientStop Color="#DBEAFE" Offset="1"/>
                                            </LinearGradientBrush>
                                        </Border.Background>
                                        <Border.Effect>
                                            <DropShadowEffect BlurRadius="10" Direction="315" ShadowDepth="1" Opacity="0.1" Color="#3B82F6"/>
                                        </Border.Effect>
                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                            <Path Data="M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z" 
                                                 Fill="{StaticResource InfoBrush}" Width="20" Height="20" Margin="0,0,12,0" Stretch="Uniform" />
                                            <TextBlock TextWrapping="Wrap" Foreground="{StaticResource InfoBrush}" FontSize="13">
                                                <Run FontWeight="SemiBold">Note:</Run> Biller GUID and Web Service Key are set on the Single Invoice tab
                                            </TextBlock>
                                        </StackPanel>
                                    </Border>

                                    <!-- Account Number Input with enhanced styling -->
                                    <Grid Grid.Row="2" Margin="0,0,0,20">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="180"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="Account Number" Style="{StaticResource FieldLabel}" 
                                                   VerticalAlignment="Center"/>
                                        <TextBox Grid.Column="1" x:Name="CustomerAccountNumber"/>
                                    </Grid>

                                    <!-- Lookup Button with enhanced styling -->
                                    <Button Grid.Row="3" Content="LOOKUP CUSTOMER" Style="{StaticResource ActionButton}" 
                                           Width="200" HorizontalAlignment="Left" Margin="0,0,0,20"
                                           Click="ProcessCustomerRecord_Click">
                                        <Button.Effect>
                                            <DropShadowEffect BlurRadius="15" Direction="315" ShadowDepth="3" Opacity="0.2" Color="#16A34A"/>
                                        </Button.Effect>
                                    </Button>

                                    <!-- Results Area with enhanced styling -->
                                    <Border Grid.Row="4" Background="{StaticResource ConsoleBackgroundBrush}" 
                                           CornerRadius="12" MinHeight="350">
                                        <Border.Effect>
                                            <DropShadowEffect BlurRadius="10" Direction="315" ShadowDepth="2" Opacity="0.1" Color="#3B82F6"/>
                                        </Border.Effect>
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="*"/>
                                            </Grid.RowDefinitions>

                                            <TextBlock Grid.Row="0" Text="CUSTOMER DETAILS" Style="{StaticResource CardTitle}" 
                                                     Margin="15,15,15,5" Foreground="{StaticResource PrimaryBrush}"/>

                                            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="15,0,15,15">
                                                <TextBlock x:Name="CustomerResult" TextWrapping="Wrap"/>
                                            </ScrollViewer>
                                        </Grid>
                                    </Border>
                                </Grid>
                            </Border>
                        </ScrollViewer>
                    </TabItem>

                    <!-- Scheduler Tab with enhanced styling -->
                    <TabItem Header="Scheduler" x:Name="SchedulerTab">
                        <Border Style="{StaticResource ModernCard}">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <!-- Card Title with icon -->
                                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,20">
                                    <Path Width="20" Height="20" Fill="{StaticResource PrimaryBrush}" Margin="0,0,10,0"
                                          Data="M15,13H16.5V15.82L18.94,17.23L18.19,18.53L15,16.69V13M19,8H5V19H9.67C9.24,18.09 9,17.07 9,16A7,7 0 0,1 16,9C17.07,9 18.09,9.24 19,9.67V8M5,21C3.89,21 3,20.1 3,19V5C3,3.89 3.89,3 5,3H6V1H8V3H16V1H18V3H19A2,2 0 0,1 21,5V11.1C22.24,12.36 23,14.09 23,16A7,7 0 0,1 16,23C14.09,23 12.36,22.24 11.1,21H5M16,11.15A4.85,4.85 0 0,0 11.15,16C11.15,18.68 13.32,20.85 16,20.85A4.85,4.85 0 0,0 20.85,16C20.85,13.32 18.68,11.15 16,11.15Z"/>

                                    <TextBlock Text="SCHEDULED TASKS" Style="{StaticResource SectionTitle}" 
                                               VerticalAlignment="Center"/>
                                </StackPanel>

                                <!-- DataGrid with enhanced styling -->
                                <Border Grid.Row="1" Background="{StaticResource CardBackgroundBrush}" 
                                       CornerRadius="12" Margin="0,0,0,20">
                                    <Border.Effect>
                                        <DropShadowEffect BlurRadius="8" Direction="315" ShadowDepth="1" Opacity="0.1" Color="#3B82F6"/>
                                    </Border.Effect>
                                    <DataGrid x:Name="ScheduledTasksGrid" Margin="2" 
                                             HeadersVisibility="Column" IsReadOnly="True" SelectionMode="Single"
                                             Background="Transparent" BorderThickness="0">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="150"/>
                                            <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="200"/>
                                            <DataGridTextColumn Header="Frequency" Binding="{Binding Frequency}" Width="100"/>
                                            <DataGridTextColumn Header="Next Run Time" Binding="{Binding NextRunTime, StringFormat=MM/dd/yyyy hh:mm tt}" Width="150"/>
                                            <DataGridCheckBoxColumn Header="Enabled" Binding="{Binding IsEnabled}" Width="70"/>
                                            <DataGridTextColumn Header="Last Run" Binding="{Binding LastRunTime, StringFormat=MM/dd/yyyy hh:mm tt}" Width="150"/>
                                            <DataGridTextColumn Header="Last Result" Binding="{Binding LastRunResult}" Width="*"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>

                                <!-- Action Buttons with enhanced styling -->
                                <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right">
                                    <Button x:Name="AddButton" Content="ADD NEW" Style="{StaticResource SecondaryButton}" 
                                           Width="120" Height="42" Margin="0,0,10,0" Click="AddSchedule"/>
                                    <Button x:Name="EditButton" Content="EDIT" Style="{StaticResource SecondaryButton}" 
                                           Width="120" Height="42" Margin="0,0,10,0" Click="EditSchedule"/>
                                    <Button x:Name="DeleteButton" Content="DELETE" Style="{StaticResource SecondaryButton}" 
                                           Width="120" Height="42" Margin="0,0,10,0" Click="DeleteSchedule"/>
                                    <Button x:Name="RunNowButton" Content="RUN NOW" Style="{StaticResource ActionButton}" 
                                           Width="120" Height="42" Click="RunNowScheduledTask"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </TabItem>

                    <!-- Windows Task Scheduler Integration Tab with enhanced styling -->
                    <TabItem Header="Windows Task Integration">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <Border Style="{StaticResource ModernCard}">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <!-- Card Title with icon -->
                                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,20">
                                        <Path Width="20" Height="20" Fill="{StaticResource PrimaryBrush}" Margin="0,0,10,0"
                                              Data="M16,12V4H17V2H7V4H8V12L6,14V16H11.2V22H12.8V16H18V14L16,12M8.8,14L10,12.8V4H14V12.8L15.2,14H8.8Z"/>

                                        <TextBlock Text="WINDOWS TASK SCHEDULER INTEGRATION" 
                                                   Style="{StaticResource SectionTitle}" VerticalAlignment="Center"/>
                                    </StackPanel>

                                    <!-- Info Panel with enhanced styling -->
                                    <Border Grid.Row="1" CornerRadius="12" Padding="16" Margin="0,0,0,20">
                                        <Border.Background>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                <GradientStop Color="#E3F2FD" Offset="0"/>
                                                <GradientStop Color="#DBEAFE" Offset="1"/>
                                            </LinearGradientBrush>
                                        </Border.Background>
                                        <Border.Effect>
                                            <DropShadowEffect BlurRadius="10" Direction="315" ShadowDepth="1" Opacity="0.1" Color="#3B82F6"/>
                                        </Border.Effect>
                                        <StackPanel>
                                            <TextBlock FontWeight="SemiBold" Foreground="{StaticResource InfoBrush}" TextWrapping="Wrap" FontSize="14">
                                                Run scheduled tasks using Windows Task Scheduler
                                            </TextBlock>
                                            <TextBlock Foreground="{StaticResource InfoBrush}" TextWrapping="Wrap" Margin="0,10,0,0" FontSize="13">
                                                Select a task from your custom schedules and create a Windows Task Scheduler entry to run it. 
                                                This allows you to leverage Windows' built-in scheduling capabilities for more reliability.
                                            </TextBlock>
                                        </StackPanel>
                                    </Border>

                                    <!-- Task Selection Area with enhanced styling -->
                                    <Grid Grid.Row="2">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="*"/>
                                        </Grid.RowDefinitions>

                                        <!-- Selected Task Header -->
                                        <Grid Grid.Row="0" Margin="0,0,0,15">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>

                                            <TextBlock Grid.Column="0" Text="SELECT A TASK TO SCHEDULE:" 
                                                       Style="{StaticResource CardTitle}" Foreground="{StaticResource PrimaryBrush}"
                                                       VerticalAlignment="Center"/>

                                            <Button Grid.Column="1" Content="REFRESH TASK LIST" 
                                                    Style="{StaticResource SecondaryButton}" Width="180" Height="38"
                                                    Click="RefreshTaskList_Click"/>
                                        </Grid>

                                        <!-- Tasks List with enhanced styling -->
                                        <Border Grid.Row="1" Background="{StaticResource GroupBackgroundBrush}"
                                               BorderBrush="{StaticResource BorderBrush}" BorderThickness="1"
                                               CornerRadius="10" Margin="0,0,0,20">
                                            <Border.Effect>
                                                <DropShadowEffect BlurRadius="8" Direction="315" ShadowDepth="1" Opacity="0.1" Color="#3B82F6"/>
                                            </Border.Effect>
                                            <ListBox x:Name="TaskSchedulerTaskList" Height="200" Background="Transparent"
                                                     BorderThickness="0" Margin="1"
                                                     DisplayMemberPath="Name" SelectionChanged="TaskSchedulerTaskList_SelectionChanged">
                                                <ListBox.ItemContainerStyle>
                                                    <Style TargetType="ListBoxItem">
                                                        <Setter Property="Padding" Value="12,10"/>
                                                        <Setter Property="Margin" Value="0,1"/>
                                                        <Setter Property="Background" Value="Transparent"/>
                                                        <Setter Property="BorderThickness" Value="0"/>
                                                        <Setter Property="Template">
                                                            <Setter.Value>
                                                                <ControlTemplate TargetType="ListBoxItem">
                                                                    <Border x:Name="Border" Background="{TemplateBinding Background}" 
                                                                           BorderBrush="{TemplateBinding BorderBrush}" 
                                                                           BorderThickness="{TemplateBinding BorderThickness}" 
                                                                           CornerRadius="6" Padding="{TemplateBinding Padding}">
                                                                        <ContentPresenter />
                                                                    </Border>
                                                                    <ControlTemplate.Triggers>
                                                                        <Trigger Property="IsSelected" Value="True">
                                                                            <Setter Property="Background" TargetName="Border" Value="{StaticResource HighlightBrush}"/>
                                                                            <Setter Property="TextElement.FontWeight" Value="SemiBold"/>
                                                                            <Setter Property="TextElement.Foreground" Value="{StaticResource PrimaryBrush}"/>
                                                                        </Trigger>
                                                                        <Trigger Property="IsMouseOver" Value="True">
                                                                            <Setter Property="Background" TargetName="Border" Value="{StaticResource HighlightBrush}"/>
                                                                        </Trigger>
                                                                    </ControlTemplate.Triggers>
                                                                </ControlTemplate>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </Style>
                                                </ListBox.ItemContainerStyle>
                                            </ListBox>
                                        </Border>
                                    </Grid>

                                    <!-- Windows Task Configuration with enhanced styling -->
                                    <Border Grid.Row="3" Background="{StaticResource GroupBackgroundBrush}" 
                                           CornerRadius="12" Padding="16" Margin="0,0,0,20">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="180"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <!-- Configuration Header -->
                                            <TextBlock Grid.Row="0" Text="WINDOWS TASK CONFIGURATION" 
                                                       Style="{StaticResource CardTitle}" Grid.ColumnSpan="2"
                                                       Foreground="{StaticResource PrimaryBrush}" Margin="0,0,0,16"/>

                                            <!-- Task Name -->
                                            <TextBlock Grid.Row="1" Text="Task Name:" 
                                                      Style="{StaticResource FieldLabel}" Margin="0,0,0,5"/>
                                            <TextBox Grid.Row="1" Grid.Column="1" x:Name="WindowsTaskNameTextBox" 
                                                    Margin="0,0,0,16"/>

                                            <!-- Task Schedule -->
                                            <TextBlock Grid.Row="2" Text="Run Schedule:" 
                                                      Style="{StaticResource FieldLabel}" Margin="0,0,0,5"/>
                                            <ComboBox Grid.Row="2" Grid.Column="1" x:Name="WindowsTaskScheduleComboBox" 
                                                     Margin="0,0,0,16">
                                                <ComboBoxItem Content="Daily"/>
                                                <ComboBoxItem Content="Weekly"/>
                                                <ComboBoxItem Content="Monthly"/>
                                                <ComboBoxItem Content="At startup"/>
                                                <ComboBoxItem Content="On idle"/>
                                            </ComboBox>

                                            <!-- Command Line -->
                                            <TextBlock Grid.Row="3" Text="Command Line:" 
                                                      Style="{StaticResource FieldLabel}" Margin="0,0,0,5"/>
                                            <Border Grid.Row="3" Grid.Column="1" Background="#F9FAFB" CornerRadius="10" Padding="14,10">
                                                <TextBlock x:Name="CommandLineTextBox" Foreground="#555" TextWrapping="Wrap"
                                                         FontFamily="Cascadia Code, Consolas, Courier New, monospace" FontSize="12"/>
                                            </Border>
                                        </Grid>
                                    </Border>

                                    <!-- Action Buttons with enhanced styling -->
                                    <Grid Grid.Row="4">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- Status Text -->
                                        <Border Grid.Column="0" Background="Transparent" CornerRadius="10" Padding="10,0">
                                            <TextBlock x:Name="TaskSchedulerStatusText" Style="{StaticResource StatusText}" 
                                                      VerticalAlignment="Center"/>
                                        </Border>

                                        <!-- Test Button -->
                                        <Button Grid.Column="1" Content="TEST TASK" Style="{StaticResource SecondaryButton}" 
                                               Width="150" Height="42" Margin="0,0,10,0" Click="TestWindowsTask_Click"/>

                                        <!-- Create Button -->
                                        <Button Grid.Column="2" Content="CREATE WINDOWS TASK" Style="{StaticResource ActionButton}" 
                                               Width="220" Height="42" Click="CreateWindowsTask_Click">
                                            <Button.Effect>
                                                <DropShadowEffect BlurRadius="15" Direction="315" ShadowDepth="3" Opacity="0.2" Color="#16A34A"/>
                                            </Button.Effect>
                                        </Button>
                                    </Grid>
                                </Grid>
                            </Border>
                        </ScrollViewer>
                    </TabItem>
                </TabControl>
            </Grid>

            <!-- Console Log Section with enhanced styling -->
            <Border Grid.Row="2" Style="{StaticResource ModernCard}" Background="{StaticResource ConsoleBackgroundBrush}" Margin="24,0,24,24">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Console Header with Search -->
                    <Grid Grid.Row="0" Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="0,0,20,0">
                            <Path Width="18" Height="18" Fill="{StaticResource PrimaryBrush}" Margin="0,0,10,0"
                                  Data="M20,19V7H4V19H20M20,3A2,2 0 0,1 22,5V19A2,2 0 0,1 20,21H4A2,2 0 0,1 2,19V5C2,3.89 2.9,3 4,3H20M13,17V15H18V17H13M9.58,13L5.57,9H8.4L11.7,12.3C12.09,12.69 12.09,13.33 11.7,13.72L8.42,17H5.59L9.58,13Z"/>

                            <TextBlock Text="CONSOLE LOG" Style="{StaticResource CardTitle}" 
                                       Foreground="{StaticResource PrimaryBrush}" VerticalAlignment="Center" Margin="0"/>
                        </StackPanel>

                        <!-- Search Box with enhanced styling -->
                        <Border Grid.Column="1" Background="{StaticResource GroupBackgroundBrush}" 
                               CornerRadius="10" Padding="0,0,0,0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- Search Icon -->
                                <Path Grid.Column="0" Data="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" 
                                     Fill="{StaticResource ForegroundBrush}" Width="18" Height="18" Opacity="0.6" Margin="14,0,8,0"/>

                                <!-- Search TextBox -->
                                <TextBox Grid.Column="1" x:Name="SearchBox" Height="40" Background="Transparent" BorderThickness="0"
                                       Padding="0" TextChanged="SearchBox_TextChanged"/>

                                <!-- Clear Button -->
                                <Button Grid.Column="2" Style="{StaticResource IconButton}" Click="ClearSearch_Click" 
                                       ToolTip="Clear Search" Width="40" Height="40">
                                    <Path Data="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" 
                                         Fill="{StaticResource ForegroundBrush}" Width="14" Height="14"/>
                                </Button>
                            </Grid>
                        </Border>

                        <!-- Search Results Count -->
                        <Border Grid.Column="2" Background="Transparent" CornerRadius="10" Padding="10,0" Margin="10,0">
                            <TextBlock x:Name="SearchResultsCount" Style="{StaticResource Caption}" 
                                       VerticalAlignment="Center" MinWidth="60"/>
                        </Border>

                        <!-- Action Buttons -->
                        <StackPanel Grid.Column="3" Orientation="Horizontal" Margin="0,0,10,0">
                            <Button Content="Clear" Style="{StaticResource SecondaryButton}" Click="ClearLog_Click" 
                                   Margin="0,0,10,0" Width="80" Height="40"/>
                            <Button Content="Save Logs" Style="{StaticResource SecondaryButton}" Click="SaveLogs_Click" 
                                   Width="110" Height="40"/>
                        </StackPanel>

                        <!-- Console Toggle Button with enhanced styling -->
                        <ToggleButton x:Name="ConsoleToggleButton" Grid.Column="4" 
                                    Style="{StaticResource ToggleIconButton}" Height="40" Width="40"
                                    ToolTip="Toggle Console" IsChecked="True" Checked="ConsoleToggle_Checked" Unchecked="ConsoleToggle_Unchecked">
                            <Path x:Name="ConsoleToggleIcon" Data="M7,10L12,15L17,10H7Z" Fill="{StaticResource ForegroundBrush}" 
                                 Width="16" Height="16" Stretch="Uniform"/>
                        </ToggleButton>
                    </Grid>

                    <!-- Enhanced Console Log Area -->
                    <RichTextBox Grid.Row="1" x:Name="ConsoleLog" Height="160">
                        <RichTextBox.Resources>
                            <Style TargetType="{x:Type Paragraph}">
                                <Setter Property="Margin" Value="0,2"/>
                            </Style>
                        </RichTextBox.Resources>
                        <FlowDocument>
                            <Paragraph>
                                <Run Foreground="{StaticResource InfoBrush}" FontWeight="Bold">Welcome to Invoice Balance Refresher!</Run>
                            </Paragraph>
                            <Paragraph>
                                <Run>Log messages and operation status will appear here.</Run>
                            </Paragraph>
                        </FlowDocument>
                    </RichTextBox>
                </Grid>
            </Border>
        </Grid>
    </Border>
</Window>
